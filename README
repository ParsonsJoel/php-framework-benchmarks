This project attempts to benchmark the baseline level of responsiveness of various web-application frameworks to discover the overhead involved in using each one.

Benchmarking Server Setup
=========================

Hardware and Operating System
-----------------------------

The benchmark is performed on an Amazon EC2 `m1.large` instance. This provides 4 EC2 compute units and 7.5 G of RAM.  The operating system is a stock 64-bit Ubuntu 10.10 image provided by <http://alestic.com/>.

Installation instructions for EC2 are beyond the scope of this project. Once you have an EC2 account at Amazon and the appropriate EC2 shell tools, run a new instance under your own username ...

    ec2-run-instances ami-688c7801 --instance-type=m1.large -k {$USERNAME}

... then SSH into the running instance to continue.

    ssh -i /path/to/id_rsa-{$USERNAME} ubuntu@{$SUBDOMAIN}.amazonaws.com


Software Installation
---------------------

After the instance comes online, use aptitude to install the following software:

    # become root
    sudo -s
    
    # initial updates
    aptitude update
    aptitude dist-upgrade

    # apache2, php, git, siege
    aptitude install \
        apache2-mpm-prefork \
        libapache2-mod-php5 \
        php-apc \
        php5-cli \
        php5-common \
        php5-curl \
        php5-dev \
        php5-mcrypt \
        php5-memcache \
        php5-mysql \
        php5-sqlite \
        php5-xmlrpc \
        php5-xsl \
        git-all \
        siege
    
    # replace /var/www with the project checkout
    rm -rf /var/www
    git clone https://pmjones@github.com/pmjones/Web-Framework-Benchmarks.git /var/www
    
    # modify the Apache DocumentRoot for the project checkout
    cd /etc/apache2/sites-available/
    cp default default-orig
    sed s~/var/www~/var/www/htdocs~ default-orig > default
    
    # turn off mod_deflate
    a2dismod deflate
    
    # make everything public to remove all chance of permissions errors,
    # then restart apache
    chmod -R 777 /var/www
    /etc/init.d/apache2 restart
    
Now you can run the benchmarks against a series of framework targets.


Running the Benchmarks
======================

 At the EC2 command line, issue the following:
    
    cd /var/www
    ./bench.php target/all.ini

(There are other target files as well.)

The script will do the following for each framework target:

- Restart Apache
- Browse to the framework once to warm up the cache
- Run `siege` against the framework 5 times for 1 minute each with 10 users
- Log the results

At the end of the benchmarking, the script will collate the logged siege results and print a report on the framework responsiveness.
